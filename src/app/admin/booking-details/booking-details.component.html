<div class="container" *ngIf="bookingDetails && listingDetails && inclusions && viewDetails; else loading">
  <!-- Traveler Details -->
  <div class="uib">
    <label>Traveler #{{ bookingDetails?.TravelerID }}</label>
    <div class="d">
      <div class="a">
        <label>Name: &nbsp;</label>
        <span>{{ bookingDetails?.TravelerFirstName }} {{ bookingDetails?.TravelerLastName }}</span>
      </div>
      <div class="a">
        <label>Username: &nbsp;</label>
        <span>{{ bookingDetails?.TravelerUsername }}</span>
      </div>
      <div class="a">
        <i class='bx bxs-phone'></i>
        <label>Phone: &nbsp;</label>
        <span>{{ bookingDetails?.TravelerMobile }}</span>
      </div> 
      <div class="a">
        <i class='bx bxs-envelope'></i>
        <label>Email: &nbsp;</label>
        <span>{{ bookingDetails?.TravelerEmail }}</span>
      </div>
    </div>
  </div>

  <!-- Payment Details -->
  <div class="pib">
    <label>Payment Details</label>
    <div class="d">
      <div class="t">
        <label>Status: &nbsp;</label>
        <span>{{ bookingDetails?.PaymentStatus }}</span>
      </div>
      <div class="t">
        <label>Transaction ID: &nbsp;</label>
        <span>1029102031923</span> <!-- leave as is -->
      </div>
      <div class="t">
        <label>Payment Method: &nbsp;</label>
        <span>GCash</span> <!-- leave as is -->
      </div>
      <div class="t">
        <label>Payment Amount: &nbsp;</label>
        <span>₱ {{ bookingDetails?.TotalAmount | number: '1.2-2' }}</span>
      </div>
    </div>
  </div>

  <!-- Merchant Details -->
  <div class="bib">
    <div class="mid">
      <label>Merchant #{{ bookingDetails?.MerchantID }}</label>
      <div class="d">
        <div class="a">
          <label>Name: &nbsp;</label>
          <span>{{ bookingDetails?.MerchantBusinessName }}</span>
        </div>
        <div class="a">
          <label>Username: &nbsp;</label>
          <span>{{ bookingDetails?.MerchantUsername }}</span>
        </div>
        <div class="a">
          <i class='bx bxs-phone'></i>
          <label>Phone: &nbsp;</label>
          <span>{{ bookingDetails?.MerchantContact }}</span>
        </div>
        <div class="a">
          <i class='bx bxs-envelope'></i>
          <label>Email: &nbsp;</label>
          <span>{{ bookingDetails?.MerchantEmail }}</span>
        </div>
        <div class="a">
          <i class='bx bxs-business'></i>
          <label>Business Type: &nbsp;</label>
          <span>{{ bookingDetails?.MerchantBusinessType }}</span>
        </div>
      </div>
    </div>

    <div class="li">
      <label>Booking ID #{{ bookingDetails?.BookingID }}</label>
      <div class="ld">
        <div class="ib">
          image here <!-- leave as is -->
        </div>
        <div class="ldesc">
          <div>
            <label>Listing: &nbsp;</label>
            <span>{{ bookingDetails?.ListingID }}</span>
          </div>
          <div>
            <label>Name: &nbsp;</label>
            <span>{{ listingDetails?.RoomName }}</span> <!-- based on room or transport logic -->
          </div>
          <div>
            <label>Inclusions: &nbsp;</label><br>
            <div class="il">
              <span *ngFor="let inclusion of inclusions">{{ inclusion }}</span>
            </div>
          </div>
          <div>
            <label>View: &nbsp;</label>
            <div class="il">
              <span>{{ viewDetails?.ViewName }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="si">
      <span>
        <h4>Booking Status:</h4>
        <h3>{{ bookingDetails?.BookingStatus }}</h3>
      </span>
      <span>
        <h4>Payment Status:</h4>
        <h3>{{ bookingDetails?.PaymentStatus }}</h3>
      </span>
      <span>
        <h4>Payout Status:</h4>
        <h3>{{ bookingDetails?.PayoutStatus }}</h3>
      </span>
      <div class="actions">
        <button [disabled]="bookingDetails?.refundAmount > 0" class="refund-button">Refund</button>
        <button (click)="initiatePayout(bookingDetails?.BookingID)" [disabled]="bookingDetails?.PayoutStatus === 'completed'" class="payout-button">Initiate Payout</button>
      </div>
    </div>

    <div class="bd">
      <label>Reservation Summary</label>
      <div class="bdr">
        <div class="rd">
          <div class="c">
            <div class="check-in">
              <h4>Check-in</h4>
              <span>{{ bookingDetails?.CheckIn | date }}</span>
            </div>
            <div class="check-out">
              <h4>Check-out</h4>
              <span>{{ bookingDetails?.CheckOut | date }}</span>
            </div>
          </div>
          <span class="sp">Total Length of Stay: {{ bookingDetails?.Duration }} days</span>
        </div>
        <div class="ba">
          <h4>Price Summary</h4>
          <span>Room: ₱{{ bookingDetails?.Subtotal | number: '1.2-2' }}</span>
          <span>Tax: ₱{{ bookingDetails?.VAT | number: '1.2-2' }}</span>
          <span>Payout Amount: ₱{{ bookingDetails?.PayoutAmount | number: '1.2-2' }}</span>
          <span id="total">Total Amount: ₱{{ bookingDetails?.TotalAmount | number: '1.2-2' }}</span>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #loading>
  <p>Loading booking details...</p>
</ng-template>

<div *ngIf="showSuccessPopup" class="popup success show">
  <p>{{ successMessage }}</p>
</div>